#!/usr/local/bin/python3
# ------------------------------------------------------------------------
import sys

from collections import deque
from datetime import datetime, timedelta
from pprint import pprint

scans_timestamps = [
    '1469849279.178834', '1469892479.178834', '1469899679.178834', '1469964479.178834',
    '1469989679.178834', '1469993279.178834', '1470068879.178834', '1470104879.178834',
    '1470180479.178834', '1470212879.178834', '1470238079.178834', '1470270479.178834',
    '1470288479.178834', '1470306479.178834', '1470382079.178834', '1470432479.178834',
    '1470515279.178834', '1470590879.178834', '1470666479.178834', '1470713279.178834',
    '1470781679.178834', '1470796079.178834', '1470828479.178834', '1470860879.178834',
    '1470878879.178834', '1470893279.178834', '1470893279.178834', '1470965279.178834',
    '1470990479.178834', '1471062479.178834', '1471098479.178834', '1471166879.178834',
    '1471170479.178834', '1471206479.178834', '1471242479.178834', '1471289279.178834',
    '1471300079.178834', '1471325279.178834', '1471393679.178834', '1471472879.178834',
    '1471541279.178834', '1471566479.178834', '1471642079.178834', '1471670879.178834',
    '1471674479.178834', '1471710479.178834', '1471717679.178834', '1471768079.178834',
    '1471778879.178834', '1471789679.178834', '1471789679.178834', '1471865279.178834',
    '1471922879.178834', '1471930079.178834', '1471987679.178834', '1472063279.178834',
    '1472117279.178834', '1472156879.178834', '1472221679.178834', '1472304479.178834',
    '1472336879.178834', '1472408879.178834', '1472426879.178834', '1472426879.178834',
    '1472426879.178834', '1472484479.178834', '1472552879.178834', '1472610479.178834',
    '1472693279.178834', '1472776079.178834', '1472819279.178834', '1472887679.178834',
    '1472894879.178834', '1472956079.178834', '1472977679.178834', '1473024479.178834',
    '1473038879.178834', '1473100079.178834', '1473154079.178834', '1473175679.178834',
    '1473186479.178834', '1473218879.178834', '1473272879.178834', '1473341279.178834',
    '1473395279.178834', '1473424079.178834', '1473424079.178834', '1473467279.178834',
    '1473488879.178834', '1473550079.178834', '1473600479.178834', '1473676079.178834',
    '1473686879.178834', '1473722879.178834', '1473769679.178834', '1473845279.178834',
    '1473884879.178834', '1473931679.178834', '1473989279.178834', '1474025279.178834',
    '1474061279.178834', '1474075679.178834', '1474104479.178834', '1474118879.178834',
    '1474187279.178834', '1474262879.178834', '1474284479.178834', '1474288079.178834',
    '1474298879.178834', '1474378079.178834', '1474453679.178834', '1474482479.178834',
    '1474514879.178834', '1474565279.178834', '1474597679.178834', '1474676879.178834',
    '1474705679.178834', '1474784879.178834', '1474792079.178834', '1474874879.178834',
    '1474885679.178834', '1474957679.178834', '1475008079.178834', '1475083679.178834',
    '1475116079.178834', '1475198879.178834', '1475224079.178834', '1475270879.178834',
    '1475328479.178834', '1475386079.178834', '1475440079.178834', '1475497679.178834',
    '1475580479.178834', '1475648879.178834', '1475688479.178834', '1475706479.178834',
    '1475753279.178834', '1475782079.178834', '1475792879.178834', '1475803679.178834',
    '1475846879.178834', '1475915279.178834', '1475994479.178834', '1476070079.178834',
    '1476142079.178834', '1476174479.178834', '1476185279.178834', '1476224879.178834',
    '1476253679.178834', '1476286079.178834', '1476340079.178834', '1476408479.178834',
    '1476430079.178834', '1476502079.178834', '1476545279.178834', '1476617279.178834',
    '1476638879.178834', '1476642479.178834', '1476649679.178834', '1476653279.178834',
    '1476703679.178834', '1476743279.178834', '1476764879.178834', '1476808079.178834',
    '1476847679.178834', '1476880079.178834', '1476901679.178834', '1476977279.178834',
    '1476984479.178834', '1476995279.178834', '1477049279.178834', '1477128479.178834',
    '1477142879.178834', '1477171679.178834', '1477193279.178834', '1477193279.178834',
    '1477261679.178834', '1477344479.178834', '1477351679.178834', '1477358879.178834',
    '1477373279.178834', '1477420079.178834', '1477459679.178834', '1477488479.178834',
    '1477506479.178834', '1477553279.178834', '1477574879.178834', '1477650479.178834',
    '1477733279.178834', '1477783679.178834', '1477855679.178834', '1477934879.178834',
    '1477970879.178834', '1478006879.178834', '1478035679.178834', '1478050079.178834',
    '1478050079.178834', '1478111279.178834', '1478140079.178834', '1478190479.178834',
    '1478251679.178834', '1478251679.178834', '1478312879.178834', '1478359679.178834',
    '1478366879.178834', '1478374079.178834', '1478446079.178834', '1478471279.178834',
    '1478518079.178834', '1478590079.178834', '1478636879.178834', '1478712479.178834',
    '1478741279.178834', '1478816879.178834', '1478824079.178834', '1478827679.178834',
    '1478874479.178834', '1478874479.178834', '1478924879.178834', '1478953679.178834',
    '1479032879.178834', '1479068879.178834', '1479086879.178834', '1479108479.178834',
    '1479137279.178834', '1479216479.178834', '1479245279.178834', '1479252479.178834',
    '1479313679.178834', '1479317279.178834', '1479374879.178834', '1479418079.178834',
    '1479493679.178834', '1479529679.178834', '1479608879.178834', '1479648479.178834',
    '1479695279.178834', '1479706079.178834', '1479770879.178834', '1479785279.178834',
    '1479846479.178834', '1479878879.178834', '1479882479.178834', '1479893279.178834',
    '1479947279.178834', '1480001279.178834', '1480026479.178834', '1480084079.178834',
    '1480120079.178834', '1480152479.178834', '1480192079.178834', '1480267679.178834',
    '1480325279.178834', '1480346879.178834', '1480411679.178834', '1480454879.178834',
    '1480462079.178834', '1480523279.178834', '1480537679.178834', '1480595279.178834',
    '1480606079.178834', '1480609679.178834', '1480670879.178834', '1480728479.178834',
    '1480796879.178834', '1480814879.178834', '1480836479.178834', '1480901279.178834',
    '1480969679.178834', '1480976879.178834', '1481048879.178834', '1481056079.178834',
    '1481077679.178834', '1481156879.178834', '1481218079.178834', '1481218079.178834',
    '1481232479.178834', '1481272079.178834', '1481308079.178834', '1481344079.178834',
    '1481383679.178834', '1481430479.178834', '1481448479.178834', '1481470079.178834',
    '1481502479.178834', '1481552879.178834', '1481563679.178834', '1481574479.178834',
    '1481632079.178834', '1481653679.178834', '1481686079.178834', '1481743679.178834',
    '1481797679.178834', '1481801279.178834', '1481837279.178834', '1481858879.178834',
    '1481887679.178834', '1481959679.178834', '1481992079.178834', '1482064079.178834',
    '1482067679.178834', '1482136079.178834', '1482168479.178834', '1482172079.178834',
    '1482272879.178834', '1482337679.178834', '1482384479.178834', '1482391679.178834',
    '1482427679.178834', '1482445679.178834', '1482481679.178834', '1482506879.178834',
    '1482528479.178834', '1482611279.178834', '1482650879.178834', '1482712079.178834',
    '1482762479.178834', '1482780479.178834', '1482856079.178834', '1482866879.178834',
    '1482910079.178834', '1482964079.178834', '1483043279.178834', '1483068479.178834',
    '1483100879.178834', '1483140479.178834', '1483158479.178834', '1483201679.178834',
    '1483212479.178834', '1483237679.178834', '1483262879.178834', '1483342079.178834',
    '1483403279.178834', '1483414079.178834', '1483424879.178834', '1483493279.178834',
    '1483543679.178834', '1483619279.178834', '1483676879.178834', '1483684079.178834',
    '1483687679.178834', '1483730879.178834', '1483745279.178834', '1483770479.178834',
    '1483777679.178834', '1483838879.178834', '1483860479.178834', '1483907279.178834',
    '1483928879.178834', '1483975679.178834', '1484040479.178834', '1484051279.178834',
    '1484105279.178834', '1484134079.178834', '1484191679.178834', '1484242079.178834',
    '1484252879.178834', '1484267279.178834', '1484274479.178834', '1484303279.178834',
    '1484364479.178834', '1484382479.178834', '1484458079.178834', '1484501279.178834',
    '1484551679.178834', '1484602079.178834', '1484630879.178834', '1484713679.178834',
    '1484778479.178834', '1484821679.178834', '1484893679.178834', '1484954879.178834',
    '1485023279.178834', '1485023279.178834', '1485070079.178834', '1485152879.178834',
    '1485196079.178834', '1485224879.178834', '1485235679.178834', '1485239279.178834',
    '1485293279.178834', '1485350879.178834', '1485433679.178834', '1485487679.178834',
    '1485498479.178834', '1485509279.178834', '1485534479.178834', '1485559679.178834',
    '1485577679.178834', '1485638879.178834', '1485664079.178834', '1485725279.178834',
    '1485754079.178834', '1485779279.178834', '1485782879.178834', '1485865679.178834',
    '1485944879.178834', '1486002479.178834', '1486027679.178834', '1486027679.178834',
    '1486096079.178834', '1486114079.178834', '1486168079.178834', '1486250879.178834',
    '1486254479.178834', '1486279679.178834', '1486297679.178834', '1486348079.178834',
    '1486412879.178834', '1486474079.178834', '1486481279.178834', '1486531679.178834',
    '1486560479.178834', '1486618079.178834', '1486686479.178834', '1486744079.178834',
    '1486787279.178834', '1486866479.178834', '1486873679.178834', '1486898879.178834',
    '1486934879.178834', '1486967279.178834', '1487032079.178834', '1487064479.178834',
    '1487096879.178834', '1487096879.178834', '1487165279.178834', '1487208479.178834',
    '1487280479.178834', '1487309279.178834', '1487392079.178834', '1487474879.178834',
    '1487518079.178834', '1487575679.178834', '1487654879.178834', '1487723279.178834',
    '1487748479.178834', '1487766479.178834', '1487770079.178834', '1487834879.178834',
    '1487870879.178834', '1487896079.178834', '1487968079.178834', '1488043679.178834',
    '1488083279.178834', '1488115679.178834', '1488115679.178834', '1488173279.178834',
    '1488248879.178834', '1488295679.178834', '1488299279.178834', '1488356879.178834',
    '1488389279.178834', '1488392879.178834', '1488407279.178834', '1488482879.178834',
    '1488500879.178834', '1488526079.178834', '1488594479.178834', '1488623279.178834',
    '1488655679.178834', '1488698879.178834', '1488756479.178834', '1488832079.178834',
    '1488842879.178834', '1488871679.178834', '1488907679.178834', '1488990479.178834',
    '1489055279.178834', '1489134479.178834', '1489152479.178834', '1489181279.178834',
    '1489217279.178834', '1489256879.178834', '1489336079.178834', '1489357679.178834',
    '1489440479.178834', '1489483679.178834', '1489483679.178834', '1489516079.178834',
    '1489580879.178834', '1489663679.178834', '1489688879.178834', '1489703279.178834',
    '1489778879.178834', '1489836479.178834', '1489854479.178834', '1489912079.178834',
    '1489984079.178834', '1490023679.178834', '1490063279.178834', '1490138879.178834',
    '1490200079.178834', '1490282879.178834', '1490347679.178834', '1490369279.178834',
    '1490448479.178834', '1490488079.178834', '1490527679.178834', '1490538479.178834',
    '1490538479.178834', '1490614079.178834', '1490621279.178834', '1490653679.178834',
    '1490668079.178834', '1490747279.178834', '1490779679.178834', '1490840879.178834',
    '1490855279.178834', '1490891279.178834', '1490920079.178834', '1490930879.178834',
    '1490963279.178834', '1491006479.178834', '1491042479.178834', '1491078479.178834',
    '1491146879.178834', '1491211679.178834', '1491265679.178834', '1491323279.178834',
    '1491373679.178834', '1491398879.178834', '1491413279.178834', '1491492479.178834',
    '1491571679.178834', '1491650879.178834', '1491701279.178834', '1491762479.178834',
    '1491805679.178834', '1491863279.178834', '1491870479.178834', '1491938879.178834',
    '1491949679.178834', '1491996479.178834', '1492050479.178834', '1492111679.178834',
    '1492154879.178834', '1492183679.178834', '1492201679.178834', '1492230479.178834',
    '1492284479.178834', '1492338479.178834', '1492352879.178834', '1492410479.178834',
    '1492417679.178834', '1492500479.178834', '1492504079.178834', '1492525679.178834',
    '1492586879.178834', '1492637279.178834', '1492691279.178834', '1492723679.178834',
    '1492748879.178834', '1492820879.178834', '1492824479.178834', '1492860479.178834',
    '1492878479.178834', '1492950479.178834', '1492997279.178834', '1493069279.178834',
    '1493090879.178834', '1493108879.178834', '1493119679.178834', '1493137679.178834',
    '1493191679.178834', '1493216879.178834', '1493260079.178834', '1493263679.178834',
    '1493292479.178834', '1493332079.178834', '1493400479.178834', '1493443679.178834',
    '1493472479.178834', '1493476079.178834', '1493486879.178834', '1493540879.178834',
    '1493612879.178834', '1493674079.178834', '1493710079.178834', '1493782079.178834',
    '1493800079.178834', '1493825279.178834', '1493825279.178834', '1493882879.178834',
    '1493940479.178834', '1494001679.178834', '1494041279.178834', '1494116879.178834',
    '1494181679.178834', '1494260879.178834', '1494296879.178834', '1494368879.178834',
    '1494379679.178834', '1494458879.178834', '1494534479.178834', '1494613679.178834',
    '1494631679.178834', '1494667679.178834', '1494696479.178834', '1494721679.178834',
    '1494743279.178834', '1494761279.178834', '1494811679.178834', '1494890879.178834',
    '1494908879.178834', '1494916079.178834', '1494937679.178834', '1494952079.178834',
    '1494995279.178834', '1495070879.178834', '1495103279.178834', '1495106879.178834',
    '1495132079.178834', '1495146479.178834', '1495157279.178834', '1495229279.178834',
    '1495283279.178834', '1495340879.178834', '1495380479.178834', '1495452479.178834',
    '1495452479.178834', '1495488479.178834', '1495520879.178834', '1495520879.178834',
    '1495564079.178834', '1495574879.178834', '1495650479.178834', '1495733279.178834',
    '1495765679.178834', '1495837679.178834', '1495880879.178834', '1495884479.178834',
    '1495924079.178834', '1495974479.178834', '1495981679.178834', '1496046479.178834',
    '1496111279.178834', '1496136479.178834', '1496165279.178834', '1496190479.178834',
    '1496204879.178834', '1496226479.178834', '1496284079.178834', '1496312879.178834',
    '1496352479.178834', '1496356079.178834', '1496370479.178834', '1496402879.178834',
    '1496402879.178834', '1496485679.178834', '1496554079.178834', '1496633279.178834',
    '1496662079.178834', '1496708879.178834', '1496788079.178834', '1496824079.178834',
    '1496860079.178834', '1496863679.178834', '1496870879.178834', '1496906879.178834',
    '1496921279.178834', '1496921279.178834', '1496978879.178834', '1497061679.178834',
    '1497068879.178834', '1497130079.178834', '1497194879.178834', '1497216479.178834',
    '1497227279.178834', '1497230879.178834', '1497234479.178834', '1497302879.178834',
    '1497382079.178834', '1497450479.178834', '1497490079.178834', '1497490079.178834',
    '1497490079.178834', '1497515279.178834', '1497526079.178834', '1497598079.178834',
    '1497673679.178834', '1497727679.178834', '1497734879.178834', '1497734879.178834',
    '1497756479.178834', '1497785279.178834', '1497868079.178834', '1497868079.178834',
    '1497940079.178834', '1498001279.178834', '1498022879.178834', '1498073279.178834',
    '1498080479.178834', '1498080479.178834', '1498156079.178834', '1498174079.178834',
    '1498210079.178834', '1498249679.178834', '1498292879.178834', '1498372079.178834',
    '1498372079.178834', '1498440479.178834', '1498523279.178834', '1498530479.178834',
    '1498588079.178834', '1498634879.178834', '1498685279.178834', '1498728479.178834',
    '1498728479.178834', '1498793279.178834', '1498825679.178834', '1498890479.178834',
    '1498901279.178834', '1498973279.178834', '1498987679.178834', '1499038079.178834',
    '1499099279.178834', '1499178479.178834', '1499182079.178834', '1499250479.178834',
    '1499254079.178834', '1499293679.178834', '1499347679.178834', '1499401679.178834',
    '1499437679.178834', '1499502479.178834', '1499578079.178834', '1499603279.178834',
    '1499610479.178834', '1499646479.178834', '1499693279.178834', '1499761679.178834',
    '1499822879.178834', '1499826479.178834', '1499905679.178834', '1499959679.178834',
    '1500031679.178834', '1500042479.178834', '1500053279.178834', '1500121679.178834',
    '1500150479.178834', '1500208079.178834', '1500208079.178834', '1500283679.178834',
    '1500366479.178834', '1500398879.178834', '1500438479.178834', '1500452879.178834',
    '1500496079.178834', '1500532079.178834', '1500596879.178834', '1500636479.178834',
    '1500650879.178834', '1500712079.178834', '1500755279.178834', '1500787679.178834',
    '1500809279.178834', '1500827279.178834', '1500859679.178834', '1500863279.178834',
    '1500910079.178834', '1500931679.178834', '1500974879.178834', '1501050479.178834',
    '1501086479.178834', '1501093679.178834', '1501136879.178834', '1501208879.178834',
    '1501219679.178834', '1501266479.178834', '1501302479.178834', '1501334879.178834',
    '1501360079.178834', '1501421279.178834', '1501475279.178834', '1501547279.178834',
    '1501576079.178834', '1501586879.178834', '1501619279.178834', '1501644479.178834',
    '1501684079.178834', '1501741679.178834', '1501806479.178834', '1501835279.178834',
    '1501864079.178834', '1501896479.178834', '1501914479.178834', '1501932479.178834',
    '1501997279.178834', '1502069279.178834', '1502080079.178834', '1502090879.178834',
    '1502098079.178834', '1502162879.178834', '1502180879.178834', '1502263679.178834',
    '1502339279.178834', '1502411279.178834', '1502436479.178834', '1502465279.178834',
    '1502540879.178834', '1502587679.178834', '1502663279.178834', '1502677679.178834',
    '1502692079.178834', '1502699279.178834', '1502731679.178834', '1502774879.178834',
    '1502807279.178834', '1502843279.178834', '1502846879.178834', '1502915279.178834',
    '1502994479.178834', '1503055679.178834', '1503102479.178834', '1503138479.178834',
    '1503163679.178834', '1503181679.178834', '1503253679.178834', '1503318479.178834',
    '1503383279.178834', '1503401279.178834', '1503473279.178834', '1503484079.178834',
    '1503484079.178834', '1503502079.178834', '1503516479.178834', '1503584879.178834',
    '1503606479.178834', '1503617279.178834', '1503660479.178834', '1503700079.178834',
    '1503739679.178834', '1503782879.178834', '1503815279.178834', '1503822479.178834',
    '1503890879.178834', '1503973679.178834', '1504024079.178834', '1504031279.178834',
    '1504052879.178834', '1504117679.178834', '1504132079.178834', '1504182479.178834',
    '1504254479.178834', '1504272479.178834', '1504301279.178834', '1504373279.178834',
    '1504391279.178834', '1504474079.178834', '1504520879.178834', '1504524479.178834',
    '1504531679.178834', '1504574879.178834', '1504614479.178834', '1504679279.178834',
    '1504751279.178834', '1504780079.178834', '1504844879.178834', '1504920479.178834',
    '1504999679.178834', '1505006879.178834', '1505006879.178834', '1505032079.178834',
    '1505032079.178834', '1505068079.178834', '1505096879.178834', '1505111279.178834',
    '1505147279.178834', '1505197679.178834', '1505258879.178834', '1505269679.178834',
    '1505269679.178834', '1505305679.178834', '1505377679.178834', '1505456879.178834',
    '1505503679.178834', '1505546879.178834', '1505590079.178834', '1505654879.178834',
    '1505737679.178834', '1505816879.178834', '1505896079.178834', '1505964479.178834',
    '1505996879.178834', '1506061679.178834', '1506061679.178834', '1506068879.178834',
    '1506086879.178834', '1506108479.178834', '1506180479.178834', '1506256079.178834',
    '1506277679.178834', '1506349679.178834', '1506425279.178834', '1506425279.178834',
    '1506468479.178834', '1506540479.178834', '1506605279.178834', '1506616079.178834',
    '1506619679.178834', '1506652079.178834', '1506702479.178834', '1506720479.178834',
    '1506738479.178834', '1506778079.178834', '1506810479.178834', '1506835679.178834',
    '1506857279.178834', '1506936479.178834', '1506950879.178834', '1507012079.178834',
    '1507033679.178834', '1507094879.178834', '1507141679.178834', '1507148879.178834',
    '1507199279.178834', '1507260479.178834', '1507325279.178834', '1507343279.178834',
    '1507418879.178834', '1507433279.178834', '1507469279.178834', '1507490879.178834',
    '1507498079.178834', '1507508879.178834', '1507570079.178834', '1507624079.178834',
    '1507663679.178834', '1507742879.178834', '1507811279.178834', '1507868879.178834',
    '1507904879.178834', '1507915679.178834', '1507926479.178834', '1507973279.178834',
    '1507994879.178834', '1508063279.178834', '1508066879.178834', '1508146079.178834',
    '1508221679.178834', '1508275679.178834', '1508311679.178834', '1508387279.178834',
    '1508459279.178834', '1508538479.178834', '1508563679.178834', '1508596079.178834',
    '1508610479.178834', '1508632079.178834', '1508635679.178834', '1508678879.178834',
    '1508747279.178834', '1508783279.178834', '1508797679.178834', '1508826479.178834',
    '1508884079.178834', '1508927279.178834', '1508988479.178834', '1509013679.178834',
    '1509071279.178834', '1509114479.178834', '1509114479.178834', '1509136079.178834',
    '1509164879.178834', '1509236879.178834', '1509305279.178834', '1509373679.178834',
    '1509420479.178834', '1509431279.178834', '1509460079.178834', '1509542879.178834',
    '1509575279.178834', '1509582479.178834', '1509593279.178834', '1509629279.178834',
    '1509672479.178834', '1509694079.178834', '1509701279.178834', '1509762479.178834',
    '1509776879.178834', '1509856079.178834', '1509906479.178834', '1509935279.178834',
    '1509960479.178834', '1510025279.178834', '1510054079.178834', '1510111679.178834',
    '1510169279.178834', '1510183679.178834', '1510183679.178834', '1510216079.178834',
    '1510288079.178834', '1510313279.178834', '1510334879.178834', '1510392479.178834',
    '1510435679.178834', '1510475279.178834', '1510529279.178834' ]


#------------------------------------------------------------------------------
# free_expired_licenses
# examines the front of the waiting queue for any licenses whose blackout periods
# have expired. If any are found, remove them from the waiting queue and place
# into the active queue
#------------------------------------------------------------------------------
def free_expired_licenses( waitq, activeq, next_scan, blackout_days=10):

    done = False
    while not done:
        if len( waitq ) == 0:
            return

        # peek at the rightmost element of the waiting queue:
        front_tuple = waitq[-1]
        last_scan   = front_tuple[1]

        # has the blackout period expired?
        if next_scan >= last_scan + timedelta( days=blackout_days ):
            print("[{0}] blackout lifted".format( front_tuple[0] ), end=" ")
            print("(from {0})".format( last_scan.ctime() ))
            activeq.appendleft( front_tuple[0] )
            waitq.pop()
        else:
            done = True

#------------------------------------------------------------------------------
# execute_scans_with_licenses
#------------------------------------------------------------------------------
def execute_scans_with_licenses( licenses, scans, blackout_days=10 ):
    # two double-ended queues (pronounced "decks"):

    # holds active licenses, ready to be consumed for a scan (initialized with
    # the initial list of licenses
    active_licenses_q = deque( licenses ) 

    # holds licenses awaiting their blackouts to expire (initially empty)
    waiting_licenses_q = deque( )

    for scan in scans:

        # first, remove any licenses from the waiting queue whose blackouts
        # have expired
        free_expired_licenses( waiting_licenses_q, active_licenses_q, scan, blackout_days )

        # are we out of active licenses?
        if len( active_licenses_q ) == 0:
            print("No active licenses to satisfy scan: " + scan.ctime())
            return False

        license_used = active_licenses_q[-1]
        print("[{0}] successful scan: {1}".format( license_used, scan.ctime()), end="; ")

        # The waiting queue is composed of two-element tuples: element-0 is
        # merely the license ID; element-1 is the associated scan which consumed it.
        # In the following statement, we simultaneously remove a license from the
        # active queue, and insert it into the waiting queue:

        waiting_licenses_q.appendleft( (active_licenses_q.pop(), scan) )
        print("{0} active remaining".format( len( active_licenses_q)))

    # we've successfully executed every scan, so return True. Namely, that
    # the given number of licenses was sufficient to cover the scheduled scans
    return True

#------------------------------------------------------------------------------
# MAIN PORTION OF SCRIPT
#------------------------------------------------------------------------------

# convert the raw scans_timestamps to scans_datetimes
scans_datetimes = []

for sts in scans_timestamps:
    scans_datetimes.append(datetime.fromtimestamp(float(sts)))

# sort scans into chronological order
scans_datetimes.sort()

# relinquish the memory associated with the raw timestamps
del scans_timestamps

num_licenses = 1
last_attempt = 0
licenses = []

done = False
while not done:
    print("\nATTEMPTING WITH {0} LICENSE(S):".format( num_licenses ))

    # License IDs appear like 'L0003'
    licenses.append( 'L{0}'.format(str(num_licenses).zfill(4)))

    # We're done when execute_scans_with_licenses completes successfully
    done = execute_scans_with_licenses( licenses, scans_datetimes )

    # note the last attempt for when the loop exits successfully
    last_attempt = num_licenses
    num_licenses += 1

print("MININUM LICENSE(S): {0}".format( last_attempt ))

# ------------------------------------------------------------------------
# vim:ts=4 sw=4 expandtab
# ------------------------------------------------------------------------
